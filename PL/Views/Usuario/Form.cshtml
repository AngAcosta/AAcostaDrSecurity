@model ML.Usuario
@{
    ViewBag.Title = "Form";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="container">
    <div class="row">
        <div class="col-md-12">
            <h2>Agregar Usuario</h2>
        </div>
    </div>

    <div class="row">
        <div class="col-md-12">
            @using (Html.BeginForm("Form", "Usuario", FormMethod.Post, new { enctype = "multipart/form-data" }))
            {
                <div class="form-horizontal">
                    <div class="form-group">
                        <div class="col-md-3">
                            @Html.LabelFor(model => model.IdUsuario, new { @class = "hidden" })
                            @Html.TextBoxFor(model => model.IdUsuario, new { @class = "hidden form-control" })
                            @Html.ValidationMessageFor(model => model.IdUsuario)
                            @*hidden*@
                        </div>
                    </div>


                    <div class="row">

                        <div class="col-md-3">
                            @Html.LabelFor(model => model.Nombre)
                            <div class="input-group">
                                <span class="input-group-addon" id="basic-addon1"><i class="fa-solid fa-user" style="color:Highlight"></i></span>
                                @Html.TextBoxFor(model => model.Nombre, new { @class = "form-control", @id = "nombre" })
                                @Html.ValidationMessageFor(model => model.Nombre)
                            </div>
                        </div>

                        <div class="col-md-3">
                            @Html.LabelFor(model => model.ApellidoPaterno)
                            <div class="input-group">
                                <span class="input-group-addon" id="basic-addon1"><i class="fa-solid fa-circle-user" style="color:Highlight"></i></span>
                                @Html.TextBoxFor(model => model.ApellidoPaterno, new { @class = "form-control", @id = "paterno" })
                                @Html.ValidationMessageFor(model => model.ApellidoPaterno)
                            </div>
                        </div>

                        <div class="col-md-3">
                            @Html.LabelFor(model => model.ApellidoMaterno)
                            @Html.TextBoxFor(model => model.ApellidoMaterno, new { @class = "form-control", @id = "materno" })
                            @Html.ValidationMessageFor(model => model.ApellidoMaterno)
                        </div>


                        <div class="col-md-3">
                            @Html.LabelFor(model => model.FechaNacimiento)
                            @Html.TextBoxFor(model => model.FechaNacimiento, new { @class = "form-control", @id = "fecha" })
                            @Html.ValidationMessageFor(model => model.FechaNacimiento)
                        </div>
                    </div>
                    <br>
                    <div class="row">

                        <div class="col-md-3">
                            @Html.LabelFor(model => model.Sexo)
                            <div class="input-group">
                                <span class="input-group-addon" id="basic-addon1"><i class="fa-solid fa-at" style="color:Highlight"></i></span>
                                @Html.TextBoxFor(model => model.Sexo, new { @class = "form-control", @id = "genero" })
                                @Html.ValidationMessageFor(model => model.Sexo)
                            </div>
                        </div>

                        <div class="col-md-3">
                            @Html.LabelFor(model => model.Telefono)
                            <div class="input-group">
                                <span class="input-group-addon" id="basic-addon1"><i class="fa-solid fa-key" style="color:Highlight"></i></span>
                                @Html.TextBoxFor(model => model.Telefono, new { @class = "form-control", @id = "telefono" })
                                @Html.ValidationMessageFor(model => model.Telefono)
                            </div>
                        </div>

                        <div class="col-md-3">
                            @Html.LabelFor(model => model.Direccion)
                            <div class="input-group">
                                <span class="input-group-addon" id="basic-addon1"><i class="fa-solid fa-calendar-days" style="color:Highlight"></i></span>
                                @Html.TextBoxFor(model => model.Direccion, new { @class = "form-control", @id = "direccion" })
                                @Html.ValidationMessageFor(model => model.Direccion)
                            </div>
                        </div>

                        <div class="col-md-3">
                            @Html.LabelFor(model => model.CURP)
                            <div class="input-group">
                                <span class="input-group-addon" id="basic-addon1"><i class="fa-solid fa-venus-mars" style="color:Highlight"></i></span>
                                @Html.TextBoxFor(model => model.CURP, new { @class = "form-control", @id = "curp" })
                                @Html.ValidationMessageFor(model => model.CURP)
                            </div>
                        </div>
                    </div>
                    <br>

                    <div class="form-group">
                        <div class="col-md-3">
                            @Html.LabelFor(model => model.EstadoNacimiento)
                            @Html.TextBoxFor(model => model.EstadoNacimiento, new { @class = "form-control", @id = "estado" })
                            @Html.ValidationMessageFor(model => model.EstadoNacimiento)
                        </div>
                    </div>
                    <br>

                    <div class="form-group">
                        <div class="col-md-3">
                            <input type="submit" value="Guardar" class="btn btn-success" />
                            @Html.ActionLink("Regresar", "GetAll", "Usuario", htmlAttributes: new { @class = "btn btn-danger" })
                        </div>
                    </div>
                </div>
            }
            <button class="btn-info" type="generar" id="generar">Generar CURP</button><br><br>
        </div>
    </div>
</div>

@section Scripts {
    <link rel="stylesheet" href="//code.jquery.com/ui/1.13.2/themes/base/jquery-ui.css">
    <link rel="stylesheet" href="/resources/demos/style.css">
    <script src="https://code.jquery.com/jquery-3.6.0.js"></script>
    <script src="https://code.jquery.com/ui/1.13.2/jquery-ui.js"></script>

    <script type="text/javascript">

        function generarCURP() {
            abc = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
            random09a = Math.floor(Math.random() * (9 - 1 + 1)) + 1;
            random09b = Math.floor(Math.random() * (9 - 1 + 1)) + 1;
            randomAZ = Math.floor(Math.random() * (26 - 0 + 1)) + 0;
            ano = Number($("#fecha").val().slice(6, 10));

            var CURP = [];
            CURP[0] = $("#paterno").val().charAt(0).toUpperCase();
            CURP[1] = $("#paterno").val().slice(1).replace(/\a\e\i\o\u/gi, "").charAt(0).toUpperCase();
            CURP[2] = $("#materno").val().charAt(0).toUpperCase();
            CURP[3] = $("#nombre").val().charAt(0).toUpperCase();
            CURP[4] = ano.toString().slice(2);
            CURP[5] = $("#fecha").val().slice(3, 5);
            CURP[6] = $("#fecha").val().slice(0, 2);
            CURP[7] = $("#genero").val().toUpperCase();
            CURP[8] = abreviacion[estados.indexOf($("#estado").val().toLowerCase())];
            CURP[9] = $("#paterno").val().slice(1).replace(/[aeiou]/gi, "").charAt(0).toUpperCase();
            CURP[10] = $("#materno").val().slice(1).replace(/[aeiou]/gi, "").charAt(0).toUpperCase();
            CURP[11] = $("#nombre").val().slice(1).replace(/[aeiou]/gi, "").charAt(0).toUpperCase();;
            CURP[12] = ano < 2000 ? random09a : abc[randomAZ];
            CURP[13] = random09b;
            return CURP.join("");
        }
        var estados = ["aguascalientes", "baja california", "baja california sur", "campeche", "chiapas", "chihuahua", "coahuila", "colima", "ciudad de mexico", "distrito federal", "durango", "guanajuato", "guerrero", "hidalgo", "jalisco", "estado de mexico", "michoacan", "morelos", "nayarit", "nuevo leon", "oaxaca", "puebla", "queretaro", "quintana roo", "san luis potosi", "sinaloa", "sonora", "tabasco", "tamaulipas", "tlaxcala", "veracruz", "yucatan", "zacatecas"];
        var abreviacion = ["AS", "BC", "BS", "CC", "CS", "CH", "CL", "CM", "CX", "DF", "DG", "GT", "GR", "HG", "JC", "MC", "MN", "MS", "NT", "NL", "OC", "PL", "QT", "QR", "SP", "SL", "SR", "TC", "TS", "TL", "VZ", "YN", "ZS"];

        $("#generar").click(function () {
            alert(generarCURP());
        });

        $(function () {
            $("#fecha").datepicker({
                dateFormat: "dd/mm/yy",
                changeMonth: true,
                chageYear: true
            });
        });
    </script>
}